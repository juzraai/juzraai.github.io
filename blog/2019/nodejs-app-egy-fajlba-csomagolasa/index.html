<!DOCTYPE html> <html lang="hu"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta http-equiv="X-UA-Compatible" content="ie=edge"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Node.js app egy f√°jlba csomagol√°sa | Zsolt Jur√°nyi (juzraai)</title> <meta name="generator" content="Jekyll v4.1.1" /> <meta property="og:title" content="Node.js app egy f√°jlba csomagol√°sa" /> <meta name="author" content="Zsolt Jur√°nyi" /> <meta property="og:locale" content="hu_HU" /> <meta name="description" content="J√∫zer szempontb√≥l nem felt√©tlen√ºl k√©nyelmes Node.js-t √©s dependency-ket telep√≠tgetni, meg parancssort nyitni a D√≠jnet Bot haszn√°lata el≈ëtt. Erre pr√≥b√°ltam megold√°st keresni. T√∂bb√©-kev√©sb√© siker√ºlt is." /> <meta property="og:description" content="J√∫zer szempontb√≥l nem felt√©tlen√ºl k√©nyelmes Node.js-t √©s dependency-ket telep√≠tgetni, meg parancssort nyitni a D√≠jnet Bot haszn√°lata el≈ëtt. Erre pr√≥b√°ltam megold√°st keresni. T√∂bb√©-kev√©sb√© siker√ºlt is." /> <link rel="canonical" href="https://juzraai.github.io/blog/2019/nodejs-app-egy-fajlba-csomagolasa/" /> <meta property="og:url" content="https://juzraai.github.io/blog/2019/nodejs-app-egy-fajlba-csomagolasa/" /> <meta property="og:site_name" content="Zsolt Jur√°nyi (juzraai)" /> <meta property="og:image" content="https://juzraai.github.io/assets/dijnet-bot/dijnet-bot-exe-vt1.png" /> <meta property="og:image:height" content="908" /> <meta property="og:image:width" content="1001" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2019-11-02T00:00:00+01:00" /> <script type="application/ld+json"> {"dateModified":"2020-07-11T11:07:54+02:00","datePublished":"2019-11-02T00:00:00+01:00","headline":"Node.js app egy f√°jlba csomagol√°sa","mainEntityOfPage":{"@type":"WebPage","@id":"https://juzraai.github.io/blog/2019/nodejs-app-egy-fajlba-csomagolasa/"},"author":{"@type":"Person","name":"Zsolt Jur√°nyi"},"image":{"width":1001,"height":908,"url":"https://juzraai.github.io/assets/dijnet-bot/dijnet-bot-exe-vt1.png","@type":"imageObject"},"description":"J√∫zer szempontb√≥l nem felt√©tlen√ºl k√©nyelmes Node.js-t √©s dependency-ket telep√≠tgetni, meg parancssort nyitni a D√≠jnet Bot haszn√°lata el≈ëtt. Erre pr√≥b√°ltam megold√°st keresni. T√∂bb√©-kev√©sb√© siker√ºlt is.","url":"https://juzraai.github.io/blog/2019/nodejs-app-egy-fajlba-csomagolasa/","@type":"BlogPosting","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <meta property="og:image:type" content="image/png" /> <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"> <link rel="manifest" href="/site.webmanifest"> <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#016fb9"> <meta name="msapplication-TileColor" content="#016fb9"> <meta name="theme-color" content="#016fb9"> <link type="application/atom+xml" rel="alternate" href="https://juzraai.github.io/feed.xml" title="Zsolt Jur√°nyi (juzraai)" /> <link rel="dns-prefetch" href="//fonts.googleapis.com/"> <link rel="dns-prefetch" href="//cdnjs.cloudflare.com"> <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Barlow+Condensed:300,300i,400,500,600|Inconsolata:400,700&amp;subset=latin-ext" /> <link rel="stylesheet" href="/assets/page.css" /> </head> <body> <nav class="navbar navbar-expand-lg navbar-dark bg-dark"> <div class="container"> <a class="navbar-brand" href="/">Zsolt</a> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <div class="collapse navbar-collapse" id="navbarSupportedContent"> <ul class="navbar-nav mr-auto w-100"> <li class="nav-item"> <a class="nav-link" href="/projects/hu/" target="">Munk√°im</a> </li> <li class="nav-item"> <a class="nav-link" href="/blog/hu/" target="">Feljegyz√©seim</a> </li> <li class="nav-item"> <a class="nav-link" href="https://github.com/juzraai" target="_blank">GitHub</a> </li> <li class="nav-item"> <a class="nav-link" href="/contact/hu/" target="">Kontakt</a> </li> </ul> </div> </div> </nav> <div class="container"> <div class="row my-5 border-bottom"> <div class="col"> <div class="mb-3 text-muted"> Nov 2, 2019 / <a class="d-inline-block mr-1 mb-1" href="/blog/hu/tag/bitdefender/">#bitdefender</a> <a class="d-inline-block mr-1 mb-1" href="/blog/hu/tag/bundle/">#bundle</a> <a class="d-inline-block mr-1 mb-1" href="/blog/hu/tag/browserify/">#browserify</a> <a class="d-inline-block mr-1 mb-1" href="/blog/hu/tag/minify/">#minify</a> <a class="d-inline-block mr-1 mb-1" href="/blog/hu/tag/nodejs/">#nodejs</a> </div> <h1>Node.js app egy f√°jlba csomagol√°sa</h1> </div> </div> <div class="row"> <div class="col content"> <ul class="list-unstyled mb-5 toc"> <li><a href="#motiv√°ci√≥-√©s-c√©lkit≈±z√©s">Motiv√°ci√≥ √©s c√©lkit≈±z√©s</a></li> <li><a href="#el≈ëk√©sz√ºletek">El≈ëk√©sz√ºletek</a></li> <li><a href="#bin√°ris-gener√°l√°sa">Bin√°ris gener√°l√°sa</a></li> <li><a href="#b-terv">B-terv</a></li> </ul> <h2 id="motiv√°ci√≥-√©s-c√©lkit≈±z√©s">Motiv√°ci√≥ √©s c√©lkit≈±z√©s</h2> <p>Az ut√≥bbi hetekben el≈ëvettem a <a href="https://github.com/juzraai/dijnet-bot">D√≠jnet Bot</a> projektemet, √©s elkezdtem tuningol√°si √∂tleteket √∂ssze√≠rni, illetve megval√≥s√≠tani. Az egyik ilyen √∂tlet a program egyetlen f√°jlba csomagol√°sa volt. V√©giggondoltam ugyanis, hogy a <strong>c√©lk√∂z√∂ns√©gem nem csak a fejleszt≈ëk, hanem mindenki</strong>, √©s egy mezei felhaszn√°l√≥ nem biztos, hogy tudja mi az a parancssor, meg nem felt√©tlen√ºl k√©nyelmes Node.js-t meg dependency-ket telep√≠tgetni, miel≈ëtt haszn√°lni tudn√° a programomat.</p> <p>A fentiek alapj√°n 2 c√©lt fogalmaztam meg: a program <strong>legyen haszn√°lhat√≥</strong></p> <ol> <li><strong>Node.js telep√≠t√©s √©s <code class="language-plaintext highlighter-rouge">npm i -g</code> futtat√°sa n√©lk√ºl,</strong></li> <li><strong>illetve parancssorba/termin√°lba p√∂ty√∂g√©s n√©lk√ºl.</strong></li> </ol> <h2 id="el≈ëk√©sz√ºletek">El≈ëk√©sz√ºletek</h2> <p>A fentiekb≈ël k√∂vetkezik, hogy a program <strong>konfigur√°lhat√≥s√°g√°t</strong> is √∫gy kellett kialak√≠tani, hogy ahhoz se kelljen parancssor. Szerencs√©re a <strong>konfigf√°jl</strong> olvas√°sa, illetve a k√∂rnyezeti v√°ltoz√≥k kezel√©se a program legels≈ë v√°ltozat√°t√≥l kezdve adott volt.</p> <p>Azonban ha elk√©pzelj√ºk, hogy duplaklikkre indul a program, √©s D√≠jnet bejelentkez√©si adatok hi√°ny√°ban kiprinteli a help-et, majd kil√©p, az nem valami felhaszn√°l√≥bar√°t m≈±k√∂d√©s. Ennek orvosl√°s√°ra a v2.0.0-ban bevezettem azt, hogy ha a sz√ºks√©ges adatokat nem kapja meg, akkor a program <strong>prompttal</strong> k√©ri be azokat a termin√°lban.</p> <p>Ennek szebb/eleg√°nsabb form√°ja lenne egy korrekt <strong>GUI</strong>, de az egy k√ºl√∂n t√∂rt√©net. üôÇ</p> <h2 id="bin√°ris-gener√°l√°sa">Bin√°ris gener√°l√°sa</h2> <p>Sz√©tn√©ztem, hogyan tudn√°m a fenti c√©lokat el√©rni, √©s az els≈ë √∫t, ami el√©m ker√ºlt, az a <strong>bin√°ris f√°jl gener√°l√°sa.</strong> Van is k√©t tool, ami ezt k√≠n√°lja: a <a href="https://www.npmjs.com/package/pkg">pkg</a> √©s a <a href="https://www.npmjs.com/package/nexe">nexe</a>. Mindkett≈ë azt csin√°lja, hogy <strong>egyetlen futtathat√≥ f√°jlba</strong> csomagolja √∂ssze</p> <ul> <li>a Node.js runtime-ot</li> <li>a programomat</li> <li>√©s a programom dependency-jeit.</li> </ul> <p>K√ºl√∂nf√©le platformokat √©s k√ºl√∂nf√©le Node.js verzi√≥kat lehet v√°lasztani, √©s a folyamat v√©g√©n minden megadott platform+Node kombin√°ci√≥ra 1-1 futtathat√≥ f√°jlt k√∂p ki, amik egyenk√©nt kb. 20-40 MB-ot nyomnak.</p> <p>A kapott f√°jl ugyan√∫gy futtathat√≥ parancssorb√≥l, mint az eredeti program, emellett duplaklikkel is ind√≠that√≥, ekkor nyit mag√°nak egy Node konzolablakot (mint amikor a Node-hoz t√°rs√≠tjuk a <code class="language-plaintext highlighter-rouge">.js</code> f√°jlunkat).</p> <p>Mindez <strong>perfekt√ºl hangzik</strong>, mert mindk√©t c√©lomat el√©rn√©m p√°r karakter le√ºt√©s√©vel, viszont a kik√∂pott <code class="language-plaintext highlighter-rouge">.exe</code> f√°jlokat a <strong>BitDefender kiv√©tel n√©lk√ºl k√°rt√©konynak √©rz√©kelte.</strong> üö® Nem D√≠jnet Bot-specifikus a probl√©ma, √©s a kiv√°lasztott Node runtime verzi√≥t√≥l sem f√ºgg. √ârdekess√©g, hogy a BitDefender a f√°jl futtat√°sa k√∂zben vagy ut√°n jelzett, ha pedig explicite k√©rtem, hogy szkennelje az <code class="language-plaintext highlighter-rouge">.exe</code> f√°jlt, akkor azt mondta, hogy minden ok√©. ü§Ø</p> <p>Tettem egy pr√≥b√°t <a href="https://electronjs.org/">Electron.js</a>-el is, ami noha j√≥val nagyobb output m√©retet gener√°l, a fenti c√©lok el√©r√©s√©n fel√ºl egyszer≈±en tudn√©k vele GUI-t is csin√°lni az appnak. A BitDefender itt is lecsapott.</p> <p>Ez nyilv√°n fals-pozit√≠v jelz√©s, √©s tal√°n lehetne is jelenteni a BitDefender-nek, de akkor vajon minden verzi√≥t be k√©ne k√ºldenem nekik? Illetve akkor ezt v√©gig k√©ne csin√°lnom a t√∂bbi antiv√≠rus szoftverrel is? Nem √©letszer≈±. A <a href="https://www.virustotal.com/gui/file/1a6c995f23c676a58de288ae8e2e7fba2f9fa4b51d90e6da4c70776fc222ad89/detection">VirusTotal szerint</a> mondjuk csak a BitDefender probl√©m√°zik:</p> <p><a href="/assets/dijnet-bot/dijnet-bot-exe-vt1.png"><img src="/assets/dijnet-bot/dijnet-bot-exe-vt1.png" alt="VirusTotal Detection" /></a></p> <p>Tippre az a baja, hogy a <code class="language-plaintext highlighter-rouge">pkg</code> √∫gy gener√°lja a kimenetet, hogy egy megl√©v≈ë <code class="language-plaintext highlighter-rouge">.exe</code> f√°jlba (<code class="language-plaintext highlighter-rouge">node.exe</code>) injekt√°lja a programomat (valahol √©rthet≈ë, hogy ez gyan√∫s, de na):</p> <p><a href="/assets/dijnet-bot/dijnet-bot-exe-vt2.png"><img src="/assets/dijnet-bot/dijnet-bot-exe-vt2.png" alt="VirusTotal Details" /></a></p> <p>T√∂bb helyen olvastam, hogy a program al√°√≠r√°sa megoldhatja a gondot. A tan√∫s√≠tv√°nyok, amiket eddig tal√°ltam, t√∂bb sz√°z dolcsiba ker√ºlnek, ami csak a D√≠jnet Bot miatt nem √©ri meg. A t√©m√°ba nem √°stam bele magam m√©lyebben, tal√°n k√©s≈ëbb megteszem. ü§® Itt ezt a sz√°lat feladtam, √©s egy <strong>B-tervet</strong> val√≥s√≠tottam meg.</p> <h2 id="b-terv">B-terv</h2> <p>Tal√°ltam egy k√∂ztes megold√°st, amivel a Node.js telep√≠t√©st ugyan nem tudom <strong>megsp√≥rolni a j√∫zernek,</strong> de az <strong>NPM-ez√©st</strong> igen, illetve a parancssor haszn√°lata is kiker√ºlhet≈ë.</p> <p>A <strong><a href="http://browserify.org/">Browserify</a></strong> jutott eszembe, ami ugye egyetlen bundle f√°jlt tud gener√°lni egy kiindul√≥ <code class="language-plaintext highlighter-rouge">.js</code> f√°jlb√≥l, v√©gigk√∂vetve annak <code class="language-plaintext highlighter-rouge">require</code> h√≠v√°sait. A <code class="language-plaintext highlighter-rouge">--node</code> kapcsol√≥val tud Node.js-kompatibilis kimenetet is gener√°lni:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>browserify index.js <span class="nt">--node</span> <span class="nt">-o</span> dijnet-bot.js
</code></pre></div></div> <p>Az √≠gy kapott <code class="language-plaintext highlighter-rouge">.js</code> f√°jl pontosan √∫gy m≈±k√∂dik, mint az <code class="language-plaintext highlighter-rouge">index.js</code>, viszont nem kell mell√© semmi m√°s: sem <code class="language-plaintext highlighter-rouge">package.json</code>, sem <code class="language-plaintext highlighter-rouge">node_modules</code> mappa. Ha a felhaszn√°l√≥ t√°rs√≠tja a <code class="language-plaintext highlighter-rouge">.js</code> f√°jlokat a Node runtime-al, akkor <strong>duplaklikkel is ind√≠that√≥, vagyis a 2. c√©lt el√©rt√ºk.</strong></p> <p>A kimeneti f√°jl m√©rete 1.3 MB, ami a 12 MB-os <code class="language-plaintext highlighter-rouge">node_modules</code> mapp√°val szemben hatalmas el≈ërel√©p√©s. Azonban √©n itt nem √°lltam meg - ham√°r csomagolunk, csomagoljunk rendesen! ü§ì</p> <p>A <code class="language-plaintext highlighter-rouge">.js</code> f√°jlok t√∂m√∂r√≠t√©si elj√°r√°sa a <em>minification</em>, melyre a standard tool az <a href="https://www.npmjs.com/package/uglify-js">Uglify JS</a>. Ez viszont els√≠rja mag√°t egy <code class="language-plaintext highlighter-rouge">const</code> keyword-t≈ël is, vagyis kell m√©g egy Babel f√°zis el√©, ami a JavaScript egy r√©gebbi verzi√≥j√°ra ford√≠tja a programom. Ut√≥bbihoz kev√©ss√© √©rtek m√©g √©s f√∂l√∂sleges bonyol√≠t√°snak is tartom, sz√≥val m√°s utat kerestem.</p> <p>T√∂bb m√°s eszk√∂z kipr√≥b√°l√°sa ut√°n r√°tal√°ltam a <a href="https://terser.org/">Terser</a>-re, ami modern JS k√≥dot is tud kezelni. A Browserify ut√°n bek√∂tve a <strong>v√©gs≈ë f√°jlm√©ret 707 KB lett.</strong></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">fs</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">browserify</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">browserify</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">terser</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">terser</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">browserify</span><span class="p">(</span><span class="dl">'</span><span class="s1">./index.js</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
		<span class="cm">/* --node */</span>
		<span class="na">bare</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
		<span class="na">browserField</span><span class="p">:</span> <span class="kc">false</span>
	<span class="p">})</span>
	<span class="p">.</span><span class="nx">bundle</span><span class="p">((</span><span class="nx">error</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
		<span class="kd">const</span> <span class="nx">bundle</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span> <span class="c1">// 1.3 MB</span>
		<span class="kd">const</span> <span class="nx">minified</span> <span class="o">=</span> <span class="nx">terser</span><span class="p">.</span><span class="nx">minify</span><span class="p">(</span><span class="nx">bundle</span><span class="p">).</span><span class="nx">code</span> <span class="c1">// 0.7 MB</span>
		<span class="nx">fs</span><span class="p">.</span><span class="nx">writeFileSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">./dijnet-bot.js</span><span class="dl">'</span><span class="p">,</span> <span class="nx">minified</span><span class="p">);</span>
	<span class="p">});</span>
</code></pre></div></div> <p>A v2.1.0 verzi√≥t√≥l kezdve a D√≠jnet Bot-hoz gener√°lok egy ilyen bundle-t is.</p> <p>A BitDefender-es fonalat lehet, hogy felveszem m√©g, h√°tha siker√ºl valahogy megoldani vagy t√∂bbet megtudni a probl√©m√°r√≥l. Emellett a GUI t√©m√°n is agyalok, hogyan tudom megoldani, Electron-nal vagy an√©lk√ºl.</p> </div> </div> <div class="row mt-3"> <div class="col text-center"> <script> if (!window.scripts) window.scripts = []; window.scripts = window.scripts.concat('https://connect.facebook.net/hu_HU/sdk.js#xfbml=1&version=v3.0'); </script> <div class="fb-like" data-href="https://juzraai.github.io/blog/2019/nodejs-app-egy-fajlba-csomagolasa/" data-layout="button_count" data-action="like" data-size="large" data-show-faces="false" data-share="true"></div> </div> </div> <div class="row my-5 border-top"> <div class="col-md-8 mt-3"> <big class="font-weight-normal text-dark"> <strong>Zsolt vagyok,</strong> full-stack fejleszt≈ë. </big> <br> Crawlereket, webalkalmaz√°sokat, statikus honlapokat √©s interakt√≠v vizualiz√°ci√≥kat k√©sz√≠tek. </div> <div class="col mt-3 small"> <ul class="list-unstyled d-flex d-md-block pl-md-3"> <li class="mr-3 mr-md-0"><a href="/projects/hu/" target="">Munk√°im</a></li> <li class="mr-3 mr-md-0"><a href="/blog/hu/" target="">Feljegyz√©seim</a></li> <li class="mr-3 mr-md-0"><a href="https://github.com/juzraai" target="_blank">GitHub</a></li> <li class="mr-3 mr-md-0"><a href="/contact/hu/" target="">Kontakt</a></li> </ul> </div> </div> <div class="row"> <div class="col mb-3 small text-center text-muted"> Copyright &copy; 2020 Zsolt Jur√°nyi | All rights reserved. </div> </div> </div> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.slim.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.min.js"></script> <script>$(function () { $('a[href^=http]').attr('target', '_blank'); })</script> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fluidbox/2.0.5/css/fluidbox.min.css"> <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-throttle-debounce/1.1/jquery.ba-throttle-debounce.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/fluidbox/2.0.5/js/jquery.fluidbox.min.js"></script> <script> $(function () { $('.content a').fluidbox(); }); </script> <script> if (!window.scripts) window.scripts = []; window.scripts = window.scripts.concat('https://www.googletagmanager.com/gtag/js?id=UA-41050675-1'); window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-41050675-1', { 'anonymize_ip': true }); </script> <div id="cc" style="display:none"> <div class="c" onclick="ccClear()"></div> <div class="p"> <p> A honlap helyes m≈±k√∂d√©s√©hez √©s n√©mi statisztik√°hoz szeretn√©k s√ºtiket haszn√°lni. <a href="/privacy/hu/">R√©szletek</a> </p> <div class="r"> <a href="javascript:void(0)" onclick="ccDeny()">Elrejt√©s</a> <a class="b" href="javascript:void(0)" onclick="ccAllow()">Enged√©lyezem</a> </div> </div> </div> <script> /* js-cookie v2.2.0 */ !function(e){var n=!1;if("function"==typeof define&&define.amd&&(define(e),n=!0),"object"==typeof exports&&(module.exports=e(),n=!0),!n){var o=window.Cookies,t=window.Cookies=e();t.noConflict=function(){return window.Cookies=o,t}}}(function(){function e(){for(var e=0,n={};e<arguments.length;e++){var o=arguments[e];for(var t in o)n[t]=o[t]}return n}function n(o){function t(n,r,i){var c;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(i=e({path:"/"},t.defaults,i)).expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*i.expires),i.expires=a}i.expires=i.expires?i.expires.toUTCString():"";try{/^[\{\[]/.test(c=JSON.stringify(r))&&(r=c)}catch(e){}r=o.write?o.write(r,n):encodeURIComponent(String(r)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=(n=(n=encodeURIComponent(String(n))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var s="";for(var f in i)i[f]&&(s+="; "+f,!0!==i[f]&&(s+="="+i[f]));return document.cookie=n+"="+r+s}n||(c={});for(var p=document.cookie?document.cookie.split("; "):[],d=/(%[0-9A-Z]{2})+/g,u=0;u<p.length;u++){var l=p[u].split("="),C=l.slice(1).join("=");this.json||'"'!==C.charAt(0)||(C=C.slice(1,-1));try{var g=l[0].replace(d,decodeURIComponent);if(C=o.read?o.read(C,g):o(C,g)||C.replace(d,decodeURIComponent),this.json)try{C=JSON.parse(C)}catch(e){}if(n===g){c=C;break}n||(c[g]=C)}catch(e){}}return c}}return t.set=t,t.get=function(e){return t.call(t,e)},t.getJSON=function(){return t.apply({json:!0},[].slice.call(arguments))},t.defaults={},t.remove=function(n,o){t(n,"",e(o,{expires:-1}))},t.withConverter=n,t}return n(function(){})}); function addClass(element, className) { element.className += ' ' + className; } function removeClass(element, className) { element.className = element.className.replace( new RegExp('( |^)' + className + '( |$)', 'g'), ' ').trim(); } var c = 'juzraai-cc-v1'; function ccInit() { var v = Cookies.get(c); var e = document.getElementById('cc'); if ('allow' == v) { e.style.display = 'none'; ccLoadScripts(); } else { if ('deny' == v) { addClass(e, 'small'); } else { removeClass(e, 'small'); } e.style.display = null; } } function ccAllow() { Cookies.set(c, 'allow', { expires: 365 }); ccInit(); } function ccClear() { Cookies.remove(c); ccInit(); } function ccDeny() { Cookies.set(c, 'deny', { expires: 7 }); ccInit(); } function ccLoadScripts() { if (!window.scripts) window.scripts = []; for (var i = 0; i < window.scripts.length; i++) { var script = document.createElement('script'); script.src = window.scripts[i]; document.body.appendChild(script); } } ccInit(); </script> </body> </html>
